<div id= "flashcard-container" data-controller="progress">
  <h2 class="top-header"><%= @book.title %></h2>
  <div class="dropdown">
    <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
      Chapter <%= params[:chapter] || "1" %>
    </button>
    <ul class="dropdown-menu">
      <% @organized_chapters.each do |organized_chapter| %>
        <li><%=link_to "Chapter #{organized_chapter}", study_book_path(@book, chapter: organized_chapter), class:"dropdown-item", data: { turbo:false }%></li>
      <% end %>
    </ul>
  </div>
  <%# put the data controller above the full array, as we'll need to give the first card active class %>
  <%# card-list will be targeted when page starts up %>
  <div style= "width: 300px;" class= "pt-4">
    <div class= "mw-100" ><%= render "shared/progressbar"%></div>
  </div>
  <div class="scene scene--card" data-controller="book" data-book-target="deck" >
    <% if @array.empty? %>
      <div class='flashcard'>
        <div class='flashcard__face flashcard__face--front'>Finished for today!</div>
      </div>
    <% else %>
      <% @array.each do |card| %>
        <div class="flashcard d-none" data-card-id="<%= card.id%>" data-book-target="card">
          <div class="flashcard__face flashcard__face--front" data-controller='speech' data-language='EN'><span data-speech-target='word'><%= card.origin_word %></span>
            <i class="fa-solid fa-volume-high" data-action='click->speech#talk'></i>
          </div>
          <p class="flashcard-instruction-front btn btn-light rounded-pill" data-action="click->book#flipCards">Flip</p>
          <div class="flashcard__face flashcard__face--back" data-controller='speech' data-language='JP'><span data-speech-target='word'><%= card.translation_word %></span>
            <i class="fa-solid fa-volume-high" data-action='click->speech#talk'></i>
            <div id="flashcard-btn">
              <button class="btn btn-primary rounded-pill" data-action="click->book#dontKnow">Don't know</button>
              <button class="btn btn-primary rounded-pill px-4" data-action="click->progress#progress click->book#destroy">Know</button>
              <p class="flashcard-instruction-back btn btn-light rounded-pill" data-action="click->book#flipCards">Flip</p>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
  <%= link_to "See your cards", book_path(@book, chapter: params[:chapter]), class:"btn btn-primary", style:"align-self: center;" %>
</div>
